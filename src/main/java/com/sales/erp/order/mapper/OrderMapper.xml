<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
     "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.sales.erp.order.dao.OrderMapper">
	
	<select id="selectProductAll" resultType="com.sales.erp.product.vo.ProductVO">
		SELECT * FROM PRODUCT
	</select>
	
	<select id="ab" resultType="com.sales.erp.order.vo.OrderJoinVO">
		SELECT O.ID AS ID, O.EMPNO AS EMPNO, O.REGDATE AS REGDATE,
		   S.NAME AS NAME, S.TEAM AS TEAM, S.AUTH AS AUTH,
		   O.PROCODE AS PROCODE, P.PRONAME AS PRONAME, O.PROAMOUNT AS PROAMOUNT,
		   ((P.SELLPRICE-P.ORIGINPRICE)*O.PROAMOUNT) AS PROFIT,
		   O.CUSTOMER AS CUSTOMER, O.ADDRESS AS ADDRESS, O.CHECKS AS CHECKS,
		   O.DELETED AS DELETED
		   FROM ORDERS O, 
		   (SELECT EMPNO, NAME, TEAM, AUTH FROM SMEMBER) S,
		   (SELECT PROCODE, PRONAME, PROAMOUNT, ORIGINPRICE, SELLPRICE FROM PRODUCT) P
		   WHERE O.EMPNO=S.EMPNO AND O.PROCODE=P.PROCODE
		   AND O.PROCODE='1004'
		   AND O.EMPNO='100'
	</select>
	
	<insert id="insertOrder" parameterType="com.sales.erp.order.vo.OrderVO">
		INSERT INTO ORDERS (ID, EMPNO, PROCODE, PROAMOUNT, REGDATE, CUSTOMER, ADDRESS, CHECKS, DELETED)
		VALUES (#{empno}||'o'||TO_CHAR(ORDERID.NEXTVAL), #{empno}, #{procode}, #{proamount}, SYSDATE, #{customer}, #{address}, 0, 0)
	</insert>
	
</mapper>
